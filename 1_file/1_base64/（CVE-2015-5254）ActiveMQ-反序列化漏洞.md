
![](E:\\work\\mm-wiki\\md\\1_file\\1_base64\（CVE-2015-5254）ActiveMQ-反序列化漏洞\d1255510-bcf1-4f27-b116-cedd291e7582.png)

![](E:\\work\\mm-wiki\\md\\1_file\\1_base64\（CVE-2015-5254）ActiveMQ-反序列化漏洞\d1255510-bcf1-4f27-b116-cedd291e7582.png)

此时会给目标ActiveMQ添加一个名为event的队列，我们可以通过http://your-
ip:8161/admin/browse.jsp?JMSDestination=event看到这个队列中所有消息：


![](E:\\work\\mm-wiki\\md\\1_file\\1_base64\（CVE-2015-5254）ActiveMQ-反序列化漏洞\830187af-2734-4d20-9b99-f71d2f4ccb64.png)

![](E:\\work\\mm-wiki\\md\\1_file\\1_base64\（CVE-2015-5254）ActiveMQ-反序列化漏洞\830187af-2734-4d20-9b99-f71d2f4ccb64.png)

点击查看这条消息即可触发命令执行，此时进入容器docker-compose exec activemq
bash，可见/tmp/success已成功创建，说明漏洞利用成功：


![](E:\\work\\mm-wiki\\md\\1_file\\1_base64\（CVE-2015-5254）ActiveMQ-反序列化漏洞\3f8e9c68-564c-4f63-b0e8-52e8bea7461f.png)

![](E:\\work\\mm-wiki\\md\\1_file\\1_base64\（CVE-2015-5254）ActiveMQ-反序列化漏洞\3f8e9c68-564c-4f63-b0e8-52e8bea7461f.png)

将命令替换成弹shell语句再利用：


![](E:\\work\\mm-wiki\\md\\1_file\\1_base64\（CVE-2015-5254）ActiveMQ-反序列化漏洞\6871f607-00e9-4d8d-8c4b-cbc9c0a94f3b.png)

![](E:\\work\\mm-wiki\\md\\1_file\\1_base64\（CVE-2015-5254）ActiveMQ-反序列化漏洞\6871f607-00e9-4d8d-8c4b-cbc9c0a94f3b.png)

值得注意的是，通过web管理页面访问消息并触发漏洞这个过程需要管理员权限。在没有密码的情况下，我们可以诱导管理员访问我们的链接以触发，或者伪装成其他合法服务需要的消息，等待客户端访问的时候触发。

## 参考链接

https://vulhub.org/#/environments/activemq/CVE-2015-5254/

